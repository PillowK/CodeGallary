using GraphSample;
using Microsoft.Graph;
using Microsoft.Kiota.Abstractions.Authentication;

string tenentId = "77b00969-8278-4fec-8997-1f3181fd089a";
string clientId = "e492edf6-8096-4b13-ade8-ec7e17fb3b71";
string secret = "dZJ8Q~B6n1T7YBB1cG15uhLVTcfO~dT2yOS61a-q";
string userAssert = "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IlhSdmtvOFA3QTNVYVdTblU3Yk05blQwTWpoQSIsImtpZCI6IlhSdmtvOFA3QTNVYVdTblU3Yk05blQwTWpoQSJ9.eyJhdWQiOiJhcGk6Ly9vcmdjaGFydC50ZWFtc3BsdXMua3IvZTQ5MmVkZjYtODA5Ni00YjEzLWFkZTgtZWM3ZTE3ZmIzYjcxIiwiaXNzIjoiaHR0cHM6Ly9zdHMud2luZG93cy5uZXQvNzdiMDA5NjktODI3OC00ZmVjLTg5OTctMWYzMTgxZmQwODlhLyIsImlhdCI6MTcxMTY4NTk5MywibmJmIjoxNzExNjg1OTkzLCJleHAiOjE3MTE2OTA2MDQsImFjciI6IjEiLCJhaW8iOiJBVFFBeS84V0FBQUFxTXlBSFRVQ2N6Mm92VkZsWHlyRCtObjd0YWhBaDFNbTdTSlBESnNibWlzM2xCdzcxMUVKWnpwa2N2NmF0YXB5IiwiYW1yIjpbInB3ZCJdLCJhcHBpZCI6IjFmZWM4ZTc4LWJjZTQtNGFhZi1hYjFiLTU0NTFjYzM4NzI2NCIsImFwcGlkYWNyIjoiMCIsImZhbWlseV9uYW1lIjoi6raMIiwiZ2l2ZW5fbmFtZSI6IuyngOyaqSIsImluX2NvcnAiOiJ0cnVlIiwiaXBhZGRyIjoiMjExLjE5Mi4xNzUuOTciLCJuYW1lIjoi6raM7KeA7JqpIiwib2lkIjoiOGExNTE1MzgtMjQyZS00NWRjLTliYmQtODQ2MTNlY2Y3ZTRhIiwib25wcmVtX3NpZCI6IlMtMS01LTIxLTI2MjQxMzEyMy0zNTczNjM0ODY4LTMxMDkzNDY2NC0xMzg5IiwicmgiOiIwLkFYQUFhUW13ZDNpQzdFLUpseDh4Z2YwSW12YnRrdVNXZ0JOTHJlanNmaGY3TzNGd0FOSS4iLCJzY3AiOiJhY2Nlc3NfYXNfdXNlciIsInN1YiI6IldDcGpJZWdoYzRVNTNlbGhEN3dMcEwtLU80cDlaYk5VQjlnUU5DbXdGTk0iLCJ0aWQiOiI3N2IwMDk2OS04Mjc4LTRmZWMtODk5Ny0xZjMxODFmZDA4OWEiLCJ1bmlxdWVfbmFtZSI6ImdkQHRlYW1zcGx1cy5rciIsInVwbiI6ImdkQHRlYW1zcGx1cy5rciIsInV0aSI6InNCcGFIcGhxR0VhU3pzSVVmVUlQQUEiLCJ2ZXIiOiIxLjAifQ.Fy7p_hvjA5hB4i6GNFTCrtQMHII4Uee5v-14ZV1uwibCrlZlYbmnJztt50bUt5qS8V3jR394ypUuOs3u1bdAZcXSvQjEWXxzkKxqaBBGCEgYOpu9thFX9KfpRIdW7FwzTxY3eCTvWoidH7TCzvJ9IJ9KzpH0SEY4USn4YuMFwSUFN5umYyi4bYyrIFkDJoUOYiEjx6MO65QnvyaLgwSEwLhZ0ownV7jDfVa9-69Gfy5QnjOGPSNNRlcQY1hvwxZ2gkDpXhTt511AheWANARbhlhcKuNVRufddDHmEkRrMd_uMhgHorukCQxh1nRmGHoGdj6o2ju9op2uHhs2DVXH_Q";

var authenticationProvider = new BaseBearerTokenAuthenticationProvider(
    new TokenProvider(clientId, tenentId, secret, userAssert));

GraphServiceClient graphClient = new GraphServiceClient(authenticationProvider);

var me = graphClient.Me.GetAsync().GetAwaiter().GetResult();
var drive = graphClient.Me.Drive.GetAsync()
    .GetAwaiter()
    .GetResult();

var recent = graphClient.Drives[drive.Id].Recent
    .GetAsRecentGetResponseAsync()
    .GetAwaiter()
    .GetResult();

Console.ReadLine();
